# E. Абракадабра


|                                       | Все языки                                   | GNU C++20 10.2   | Clang14 C++20    |
| ------------------------------------- | --------------------------------------------------- | ---------------- | ---------------- |
| Ограничение времени | 4 секунды                                    | 2 секунды | 2 секунды |
| Ограничение памяти   | 256Mb                                               | 256Mb            | 256Mb            |
| Ввод                              | стандартный ввод или input.txt    |                  |                  |
| Вывод                            | стандартный вывод или output.txt |                  |                  |

Недавно Кузя разбирал чердак на даче своей бабушки и нашел очень древнюю и непонятную книгу. Кузя сразу понял, что это книга с заклинаниями, а бабушка — волшебница, просто это скрывает.

А раз бабушка умеет творить магию, то и Кузя сможет! Кузя решил тут же применить свои недюжинные навыки чтения и прочитать какие-нибудь заклинания из книги.

В дальнейшем будем считать, что все записи в книге представляют собой одну большую строку **S**. Все символы в книге представляют собой малые латинские буквы.

Кузя смотрел много фильмов про волшебников, поэтому знает два важных правила:

* Если в данный момент прочитан символ на позиции **i**, то следующим Кузя должен прочитать символ на позиции **p**i;
* Пусть **k**i — порядковый номер в алфавите символа на **i**-й позиции в тексте (**a** — **0**-й, **z** — **2**5-й). Если Кузя за время одного заклинания должен прочитать символ на **i**-й позиции в **m**i-й раз, то вместо этого он вслух произносит символ с порядковым номером в алфавите **(**k**i**+**(**m**i**−**1**)**⋅**d**i**)**mod**2**6**.

Подробный пример находится в примечании к тестовым примерам (в самом низу).

Обратите внимание, что изменения символов при прочтении действуют только в рамках одного заклинания (**m**i считаются независимо для каждого прочтения заклинания).

Кузя считает, что сила прочитанного заклинания равна количеству уникальных символов, которые в него вошли. К примеру, в заклинании «**z**b**a**c**b**e**f**» ровно **6** уникальных символов **[**a**,**b**,**c**,**e**,**f**,**z**]**.

Кузя нашел на обложке книги число **K** и понял, что для оптимального эффекта необходимо прочесть заклинания всех длин от **1** до **K** включительно, начав по очереди с каждого символа от **1** до **N** (всего Кузя планирует прочесть **N**×**K** заклинаний).

Кузя боится слишком мощных выбросов магической энергии. Поэтому он просит вас, как победителя викторины по Гарри Поттеру в **5**-м классе, заранее вычислить суммарную силу всех **N**×**K** заклинаний, которые он собирается прочесть.

## Формат ввода

В первой строке дано два целых числа **N** и **K**(**1**≤**N**≤**1**0^**5**,**1**≤**K**≤**1**0^**9**) — количество символов в тексте книги.Во второй строке дана строка **S** длины **N**, состоящая из малых латинских букв **(**S**i**∈**[**a**…**z**]**) — текст книги с заклинаниями.

В третьей строке дано **N** целых чисел **p**i через пробел **(**1**≤**p**i**≤**N**) — позиция символа, который следует прочесть после чтения символа на **i**-й позиции.

В четвертой строке дано **N** целых чисел **d**i через пробел **(**0**≤**d**i**≤**2**5) — сдвиг при повторном чтении символа на **i**-й позиции (читайте условие и примечание).

## Формат вывода

В единственной строке выведите единственное число — суммарную силу всех **N**×**K** заклинаний, начинающихся в каждой из позиций **1**,**2**,**…**,**N** и имеющих длину **1**,**2**,**…**,**K**.

### Пример 1


| Ввод![Скопировать ввод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) | Вывод![Скопировать вывод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) |
| ------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 3 7                                                                                                     | 74                                                                                                          |
| abz                                                                                                     |                                                                                                             |
| 3 1 2                                                                                                   |                                                                                                             |
| 4 0 3                                                                                                   |                                                                                                             |

### Пример 2


| Ввод![Скопировать ввод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) | Вывод![Скопировать вывод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) |
| ------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 4 6                                                                                                     | 62                                                                                                          |
| abcd                                                                                                    |                                                                                                             |
| 2 3 1 4                                                                                                 |                                                                                                             |
| 1 0 2 13                                                                                                |                                                                                                             |

### Пример 3


| Ввод![Скопировать ввод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) | Вывод![Скопировать вывод](https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif) |
| ------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| 10 1000000000                                                                                           | 259999995297                                                                                                |
| qwertzxcvb                                                                                              |                                                                                                             |
| 2 3 4 5 3 4 8 7 10 2                                                                                    |                                                                                                             |
| 1 2 3 4 5 6 7 8 9 10                                                                                    |                                                                                                             |

## Примечания

Пояснение к первому тестовому примеру.* Текст в книге равен строке **S**= «**a**b**z**»;

* Массив **p** равен **[**3**,**1**,**2**]**;
* Массив **d** равен **[**4**,**0**,**3**]**;

Разберем детально чтение одного из заклинаний: пусть Кузя начнёт читать заклинание с позиции **3** в тексте и прочтёт **7** символов. В таком случае он прочтёт строку «**z**b**a**c**b**e**f**»:

1. Символ на **3**-й позиции равен **z**. Кузя читает его в **m**3=**1-й раз, поэтому он читает символ **z** без изменений. После этого Кузя должен прочесть символ на позиции **p**3**=2;
2. Аналогично Кузя читает символ **b** на **2**-й позиции в **m**2=**1-й раз, поэтому он читает именно символ **b** и переходит к символу **p**2**=1;
3. Далее Кузя читает символ **a** на **1**-й позиции в **m**1=**1-й раз, поэтому он читает символ **a** без изменений и переходит к символу **p**1**=3;
4. Кузя читает символ на позиции **3**, но уже в **m**3=**2-й раз. Из этого следует, что на самом деле Кузя должен произнести не **z** (**2**5-й в алфавите), а **(**2**5**+**(**2**−**1**)**⋅**3**)**mod**2**6=**2**-й символ в алфавите - это символ **c**. После чего Кузя снова должен перейти к символу на позиции **p**3=2;
5. Так как **d**2=0, то на **2**-й позиции Кузя будет всегда читать один и тот же символ **b**;
6. А вот вместо символа **a** (**0**-й в алфавите) на позиции **1** Кузя в **m**1=**2-й раз прочтёт символ **(**0**+**(**2**−**1**)**⋅**4**)**mod**2**6**=4-й символ в алфавите — символ **e**;
7. Завершает Кузя чтением символа на позиции **3** в **m**3=**3-й раз, поэтому в этот раз он прочтёт **(**2**5**+**(**3**−**1**)**⋅**3**)**mod**2**6=5-й символ в алфавите - это символ f.

Список всех заклинаний, которые Кузя прочтёт:

Начиная с позиции **1**:

1. **a** — сила **1**;
2. **a**z — сила **2**;
3. **a**z**b** — сила **3**;
4. **a**z**b**e — сила **4**;
5. **a**z**b**e**c** — сила **5**;
6. **a**z**b**e**c**b — сила **5** (символ **b** уже встречался ранее, поэтому не увеличивает силу);
7. **a**z**b**e**c**b**i** — сила **6** (**i** получился как **4**-й символ после **e**).

Начиная с позиции **2**:

1. **b** — сила **1**;
2. **b**a — сила **2**;
3. **b**a**z** — сила **3**;
4. **b**a**z**b — сила **3**;
5. **b**a**z**b**e** — сила **4**;
6. **b**a**z**b**e**c — сила **5**;
7. **b**a**z**b**e**c**b** — сила **5**.

Начиная с позиции **3** (подробно описаны выше):

1. **z** — сила **1**;
2. **z**b — сила **2**;
3. **z**b**a** — сила **3**;
4. **z**b**a**c — сила **4**;
5. **z**b**a**c**b** — сила **4**;
6. **z**b**a**c**b**e — сила **5**;
7. **z**b**a**c**b**e**f** — сила **6**.

Суммарная сила всех прочтённых заклинаний равна **7**4.

Пояснение ко второму тестовому примеру.

Список всех заклинаний, которые Кузя прочтёт:

Начиная с позиции **1**:

1. **a** — сила **1**;
2. **a**b — сила **2**;
3. **a**b**c** — сила **3**;
4. **a**b**c**b — сила **3** (**b** получился как **1**-й символа после **a**);
5. **a**b**c**b**b** — сила **3**;
6. **a**b**c**b**b**e — сила **4** (**e** получился как **2**-й символ после **c**).

Начиная с позиции **2**:

1. **b** — сила **1**;
2. **b**c — сила **2**;
3. **b**c**a** — сила **3**;
4. **b**c**a**b — сила **3**;
5. **b**c**a**b**e** — сила **4**;
6. **b**c**a**b**e**b — сила **4**.

Начиная с позиции **3**:

1. **c** — сила **1**;
2. **c**a — сила **2**;
3. **c**a**b** — сила **3**;
4. **c**a**b**e — сила **4**;
5. **c**a**b**e**b** — сила **4**;
6. **c**a**b**e**b**b — сила **4**.

Начиная с позиции **4**:

1. **d** — сила **1**;
2. **d**q — сила **2** (**q** получился как **1**3-й символ после **d**);
3. **d**q**d** — сила **2** (**d** получился как **1**3-й символ после **q**);
4. **d**q**d**q — сила **2**;
5. **d**q**d**q**d** — сила **2**;
6. **d**q**d**q**d**q — сила **2**.

Суммарная сила всех прочтённых заклинаний равна **6**2.

Пояснение к третьему тестовому примеру.

В данном тесте мы ограничимся только одним из **1**0 миллиардов прочтённых Кузей заклинаний.

Если начать с позиции **1** и прочесть **7** символов, то получится заклинание «**q**w**e**r**t**h**v**»:

1. **q** на позиции **1**;
2. **w** на позиции **2**;
3. **e** на позиции **3**;
4. **r** на позиции **4**;
5. **t** на позиции **5**;
6. **h** на позиции **3** (во **2**-й раз вместо **4**-го символа в алфавите «**e**» Кузя произнесёт **4**+**3**⋅**(**2**−**1**)**=**7**-й символ);
7. **v** на позиции **4** (во **2**-й раз вместо **1**7-го символа в алфавите «**r**» Кузя произнесёт **1**7**+**4**⋅**(**2**−**1**)**=**2**1**-й символ).
